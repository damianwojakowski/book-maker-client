"use strict";
var webpack = require('webpack');
var tsc_wrapped_1 = require('@angular/tsc-wrapped');
var plugin_1 = require('./plugin');
var WebpackWrapper = (function () {
    function WebpackWrapper(webpackConfigPath) {
        this.webpackConfigPath = webpackConfigPath;
    }
    WebpackWrapper.prototype.init = function () {
        try {
            var config = require(this.webpackConfigPath);
            this.config = typeof config === 'function' ? config() : config;
        }
        catch (err) {
            throw new tsc_wrapped_1.UserError("Invalid webpack configuration. Please set a valid --webpack argument.\n" + err.message);
        }
        this.compiler = webpack(this.config);
        this.plugin = this.compiler.options.plugins
            .filter(function (p) { return p instanceof plugin_1.NgcWebpackPlugin; })[0];
    };
    WebpackWrapper.prototype.emitOnCompilationSuccess = function () {
        if (typeof this.plugin.options.onCompilationSuccess === 'function') {
            this.plugin.options.onCompilationSuccess.call(this);
        }
    };
    WebpackWrapper.prototype.emitOnCompilationError = function (err) {
        if (typeof this.plugin.options.onCompilationError === 'function') {
            this.plugin.options.onCompilationError.call(this, err);
        }
    };
    return WebpackWrapper;
}());
exports.WebpackWrapper = WebpackWrapper;
//# sourceMappingURL=webpack-wrapper.js.map